---
title: Trabalho de Estatística Computacional sobre erros Tipo I e Tipo II    
author:    
   - Rafael Alisson Schipiura    
   - Matheus Born Cabús 
date: 4 de Abril de 2024    
fontsize: 8pt    
output:    
   beamer_presentation:    
      slide_level: 2    
      latex_engine: xelatex
---

```{r echo=FALSE}
options(digits=3)
RNGkind("Mersenne-Twister")
RNGversion("4.1.2")
set.seed(1752031105)
library(formatR)
knitr::opts_chunk$set(tidy.opts = list(width.cutoff = 60), tidy = TRUE)
```

## Parâmetros 

```{r}
tamanhos <- 3 * 10 ^ c(0:3)
significancias <- c(0.2, 0.1, 0.05, 0.01, 0.001)
delta <- 0.2

```

## Função Simulação

```{r}
cobertura <- function(n_c, sig){
   mu_c <- rnorm(1) 
   amostra_c <- rnorm(n_c, mean=mu_c)
   IC_t.test <- t.test(amostra_c, conf.level=(1-sig))$conf.int
   errado.tipoI <- IC_t.test[1] > mu_c | mu_c > IC_t.test[2]
   errado.tipoII <- abs(mu_c) > delta & IC_t.test[1] < 0 & 0 < IC_t.test[2] 
   return(c(errado.tipoI, errado.tipoII))
}

```

## Simulação

```{r}
resultado <- vector("list", length(tamanhos)) 
names(resultado) <- tamanhos
for(n in tamanhos){
   resultado[[as.character(n)]] <- matrix(nrow=length(significancias), ncol=2) 
   rownames(resultado[[as.character(n)]]) <- paste0(100*significancias, "%")
   colnames(resultado[[as.character(n)]]) <- c("Tipo I", "Tipo II") 
   for(a in 1:length(significancias)){
      alpha = significancias[a]
      resultado[[as.character(n)]][a,] <- rowMeans(replicate(1000, cobertura(n, alpha)))
   }
}

```

## Resultado 

```{r, results='asis'}
for(tam in tamanhos){
   cat("\n## Amostra n = ", tam, "\n\n")
   cat(knitr::kable(100*resultado[[as.character(tam)]], "latex"), "\n\n")
}
```
